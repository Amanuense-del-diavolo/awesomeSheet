var nif={"input-race-class":"Elf Wizard","input-name":"Nif Amakir","input-level":"6","input-size":"Medium","input-alignment":"Lawful Neutral","input-xp":"23,264","input-height":"6'0","input-weight":"136 lbs","input-age":"120 years","input-gender":"Male","input-speed":"30 feet, 6 squares","input-initiative":"3","input-gold":"1,090","input-hero-points":"2","input-stat-str":"8","input-stat-dex":"17","input-stat-con":"14","input-stat-int":"21","input-stat-wis":"12","input-stat-cha":"10","input-stat-int-temp":"23","input-body-slot-headband":"Headband of Vast Intelligence +2","input-body-slot-neck":"Amulet of Natural Armor +1","input-body-slot-ring-left-hand":"Ring of Sustenance","input-body-slot-shoulders":"Cloak of Resistance +2","input-hp":"42","input-current-hp":"42","input-ac-natural":"1","input-fortitude-base":"2","input-fortitude-misc":"5","input-reflex-base":"2","input-reflex-misc":"2","input-will-base":"5","input-will-misc":"2","input-base-attack":"3","input-concentration":"11","input-skill-appraise-ranks":"4","input-skill-appraise-misc":"3","input-skill-knowledge-arcana-ranks":"3","input-skill-knowledge-arcana-misc":"3","input-skill-knowledge-dungeoneering-ranks":"2","input-skill-knowledge-dungeoneering-misc":"3","input-skill-knowledge-engineering-ranks":"1","input-skill-knowledge-engineering-misc":"3","input-skill-knowledge-geography-ranks":"1","input-skill-knowledge-geography-misc":"3","input-skill-knowledge-history-ranks":"1","input-skill-knowledge-history-misc":"3","input-skill-knowledge-local-ranks":"1","input-skill-knowledge-local-misc":"3","input-skill-knowledge-nature-ranks":"1","input-skill-knowledge-nature-misc":"3","input-skill-knowledge-nobility-ranks":"1","input-skill-knowledge-nobility-misc":"3","input-skill-knowledge-planes-ranks":"3","input-skill-knowledge-planes-misc":"3","input-skill-knowledge-religion-ranks":"3","input-skill-knowledge-religion-misc":"3","input-skill-linguistics-ranks":"3","input-skill-linguistics-misc":"3","input-skill-perception-ranks":"6","input-skill-perception-misc":"4","input-skill-sense-motive-ranks":"6","input-skill-sense-motive-misc":"2","input-skill-spellcraft-ranks":"6","input-skill-spellcraft-misc":"3","input-skill-use-magic-device-ranks":"6","input-spells-daily-level-0":"4","input-spell-dc-level-0":"16","input-spells-daily-level-1":"5","input-spell-dc-level-1":"17","input-spells-daily-level-2":"4","input-spell-dc-level-2":"18","input-spells-daily-level-3":"3","input-spell-dc-level-3":"19","spell-saved-bleed":'{"name":"Bleed","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-erase":'{"name":"Erase","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-daze":'{"name":"Daze","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-disrupt-undead":'{"name":"Disrupt Undead","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-touch-of-fatigue":'{"name":"Touch of Fatigue","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-prestidigitation":'{"name":"Prestidigitation","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-light":'{"name":"Light","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-ghost-sound":'{"name":"Ghost Sound","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-spark":'{"name":"Spark","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-acid-splash":'{"name":"Acid Splash","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-mage-hand":'{"name":"Mage Hand","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-flare":'{"name":"Flare","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-detect-magic":'{"name":"Detect Magic","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-detect-poison":'{"name":"Detect Poison","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-dancing-lights":'{"name":"Dancing Lights","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-mending":'{"name":"Mending","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-arcane-mark":'{"name":"Arcane Mark","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-message":'{"name":"Message","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-ray-of-frost":'{"name":"Ray of Frost","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-read-magic":'{"name":"Read Magic","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-open-close":'{"name":"Open Close","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-resistance":'{"name":"Resistance","level":"0","prepared":0,"active":false,"cast":0}',"spell-saved-comprehend-languages":'{"name":"Comprehend Languages","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-enlarge-person":'{"name":"Enlarge Person","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-feather-fall":'{"name":"Feather Fall","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-grease":'{"name":"Grease","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-mage-armor":'{"name":"Mage Armor","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-mount":'{"name":"Mount","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-obscuring-mist":'{"name":"Obscuring Mist","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-protection-from-chaos":'{"name":"Protection from Chaos","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-protection-from-evil":'{"name":"Protection from Evil","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-shield":'{"name":"Shield","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-summon-monster-i":'{"name":"Summon Monster I","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-unseen-servant":'{"name":"Unseen Servant","level":"1","prepared":0,"active":false,"cast":0}',"spell-saved-blur":'{"name":"Blur","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-create-pit":'{"name":"Create Pit","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-flaming-sphere":'{"name":"Flaming Sphere","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-glitterdust":'{"name":"Glitterdust","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-invisibility":'{"name":"Invisibility","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-levitate":'{"name":"Levitate","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-mirror-image":'{"name":"Mirror Image","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-resist-energy":'{"name":"Resist Energy","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-stone-call":'{"name":"Stone Call","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-summon-monster-ii":'{"name":"Summon Monster II","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-web":'{"name":"Web","level":"2","prepared":0,"active":false,"cast":0}',"spell-saved-stinking-cloud":'{"name":"Stinking Cloud","level":"3","prepared":0,"active":false,"cast":0}',"spell-saved-summon-monster-iii":'{"name":"Summon Monster III","level":"3","prepared":0,"active":false,"cast":0}',"spell-saved-spiked-pit":'{"name":"Spiked Pit","level":"3","prepared":0,"active":false,"cast":0}',"spell-saved-aqueous-orb":'{"name":"Aqueous Orb","level":"3","prepared":0,"active":false,"cast":0}',"spell-saved-fly":'{"name":"Fly","level":"3","prepared":0,"active":false,"cast":0}',"spell-saved-sleet-storm":'{"name":"Sleet Storm","level":"3","prepared":0,"active":false,"cast":0}',"textarea-feats":"Alertness, Augment Summoning, Craft Wondrous Item, Greater Spell Focus (Conjuration), Scribe Scroll, Spell Focus (Conjuration)","textarea-traits":"<strong>Resilient</strong> (+1 trait bonus on Fortitude saves)\n ","textarea-languages":"Celestial, Common, Draconic, Dwarven, Elven, Giant, Gnome, Goblin, Orc, Sylvan, Undercommon","textarea-special-abilities":'<strong>Arcane bond (Su)</strong> Rat (Bower, +2 Fortitude save),\n <strong>Bonus feats</strong>,\n <strong>Cantrips</strong>,\n <strong>Arcane schools</strong> (Conjuration),\n <strong>Teleportation sub school</strong>,\n <strong>Opposition arcane school</strong> (Enchantment, Necromancy),\n <strong>Elven Immunities (Ex)</strong> (+2 against enchantment spells and effects),\n <strong>Elven Magic (Ex)</strong> (+2 caster level checks made to overcome SR. +2 Spellcraft check to identify properties of magic items),\n <strong>Keen Senses (Ex)</strong> (+2 Perception checks),\n <strong>Low-Light Vision (Ex)</strong> (see x2 as far as humans in low illumination),\n <strong>Headband of Intellect Skill</strong> (Use Magic Device),\n <strong>Linguistics Skill</strong> (Dwarven, Giant, Undercommon),\n <strong>Shift (Su)</strong> (Teleport 15 feet 9 times per day),\n <strong>Summoner\'s Charm (Su)</strong> (+2 rounds duration for Conjuration [summoning] spells),\n <strong>Weapon Familiarity (Ex)</strong> (Proficient with longbows [including composite longbows], longswords, rapiers, and shortbows [including composite shortbows], treat weapon with "elven" in name as a martial weapon)\n ',"textarea-gear":"Spell component pouch, Spellbook, Backpack, Flask of Oil x3, Pouch (belt), Sack, Candle, Flint and Steel, Tindertwig, Rations (5 days), Waterskin, Bedroll, Blanket, Bloodblock, Healer's Kik, Rope (silk), Mirror, Compass, Ink, Inkpen, Paper sheets, Case for maps/scrolls, Scroll Case, Combat trained horse","textarea-magic-gear":"Pearl of Power (1st Level), Potion of CLW x1, Potion of Aid, Vile of Antitoxin, Vile of Holy Water, Scroll of Acid Pit x1, Scroll of Summon Monster III x5, Scroll of Invisibility x2, Scroll of Create Pit x1, Scroll of Web x4, Scroll of Stinking Cloud x2, Scroll of Grease x2, Scroll of Mirror Image x3, Scroll of Spiked Pit x3 Scroll of Fly x2","textarea-defense-notes":"+2 against enchantment spells and effects","clone-attack-count":1,"input-weapon-1":"Dagger MW","input-attack-1":"3","input-damage-1":"1d6-1","input-critical-1":"19–20/×2","input-ammo-1":"-","input-range-1":"-","clone-consumable-count":3,"input-consumable-1":"Wand of Infernal Healing","input-consumable-total-1":"50","input-consumable-used-1":"48","input-consumable-2":"Wand of Lightning Bolt","input-consumable-total-2":"50","input-consumable-used-2":"38","input-consumable-3":"Shift","input-consumable-total-3":"9","input-consumable-used-3":""}(function(){function a(a){return document.querySelector(a)}function b(a){return document.querySelectorAll(a)}function c(a,b){a.classList.toggle(b)}function d(a,b){a.classList.add(b)}function e(a,b){a.classList.remove(b)}function f(a,b){for(var c=b.charAt(0);a&&a!==document;a=a.parentNode){if("."===c&&a.classList.contains(b.substr(1)))return a;if("#"===c&&a.id===b.substr(1))return a;if("["===c&&a.hasAttribute(b.substr(1,b.length-2)))return a;if(a.tagName.toLowerCase()===b)return a}return!1}function g(a){var b=parseInt(a.value,10)||0;return b}function h(a,b){window.setTimeout(a,b)}function i(a,b){localStorage.getItem&&localStorage.setItem(a,b)}function j(a){localStorage.getItem&&localStorage.removeItem(a)}function k(a){if(""==localStorage.getItem(a))localStorage.removeItem(a);else if(localStorage.getItem(a))return localStorage.getItem(a)}function l(){k("current-character-count")?ma=k("current-character-count"):(ma=1,i("current-character-count",ma))}function m(){na=k("character-"+ma)?JSON.parse(k("character-"+ma)):nif}function n(){for(var b in na)"textarea"==b.substring(0,8)&&(a("#"+b).innerHTML=na[b]);for(var b in na)"input"==b.substring(0,5)&&(a("#"+b).value=na[b])}function o(){i("character-"+ma,JSON.stringify(na)),console.log(na)}function p(){var a=Pa.querySelector("span"),b=window.document,d=b.documentElement,e=d.requestFullscreen||d.mozRequestFullScreen||d.webkitRequestFullScreen||d.msRequestFullscreen,f=b.exitFullscreen||b.mozCancelFullScreen||b.webkitExitFullscreen||b.msExitFullscreen;b.fullscreenElement||b.mozFullScreenElement||b.webkitFullscreenElement||b.msFullscreenElement?(f.call(b),c(Pa,"active"),c(a,"icon-fullscreen-exit"),c(a,"icon-fullscreen")):(e.call(d),c(Pa,"active"),c(a,"icon-fullscreen-exit"),c(a,"icon-fullscreen"))}function q(a){a.value<=0?a.value="":a.value>=100&&(a.value=100)}function r(a){function b(){var a=document.createElement("div");a.setAttribute("class","check-group"),d.appendChild(a)}var c=f(a,".clone"),d=c.querySelector(".consumable-counts"),e=parseInt(a.value,10)||0,g=d.querySelector(".check-group"),h=d.querySelectorAll(".check").length;for(g||e>0&&b();e>h;){var g=d.lastChild;g.children.length>=10&&(b(),g=d.lastChild);var i=document.createElement("span");i.setAttribute("class","check"),g.appendChild(i),h++}for(;h>e;){var g=d.lastChild;g.children.length>0&&g.removeChild(g.lastChild),g.children.length<=0&&(g.remove(),h>0&&(g=d.querySelector(".check-group"))),h--}s(a)}function s(a){for(var b=f(a,".clone"),c=b.querySelector(".consumable-counts"),g=b.querySelector(".consumable-used"),h=parseInt(g.value,10)||0,i=c.querySelectorAll(".check"),j=i.length-h,k=0;k<i.length;k++)d(i[k],"used");for(var k=0;j>k;k++)e(i[k],"used")}function t(){for(var a=b(".consumable-total"),c=0;c<a.length;c++)r(a[c])}function u(){for(var a=b(".consumable-used"),c=0;c<a.length;c++)s(a[c])}function v(){var b=a(".consumables .clone-add"),c=a(".consumables .clone-remove"),d=a(".attacks .clone-add"),e=a(".attacks .clone-remove");b.addEventListener("click",function(){w(".consumables"),ea("Consumables block added.",!1,!1)},!1),c.addEventListener("click",function(){y(".consumables")},!1),d.addEventListener("click",function(){w(".attacks"),ea("Attack block added.",!1,!1)},!1),e.addEventListener("click",function(){y(".attacks")},!1)}function w(b){function c(a){a&&(a.addEventListener("input",function(){$(a)},!1),a.addEventListener("focus",function(){$(a)},!1),a.addEventListener("blur",function(){$(a)},!1))}function d(a){a&&(a.addEventListener("input",function(){ba(a)},!1),a.addEventListener("focus",function(){ba(a)},!1),a.addEventListener("blur",function(){ba(a)},!1))}function e(a){a&&(a.addEventListener("input",function(){q(a)},!1),a.addEventListener("focus",function(){q(a)},!1),a.addEventListener("blur",function(){q(a)},!1))}function f(a){a&&(a.addEventListener("input",function(){r(a)},!1),a.addEventListener("focus",function(){r(a)},!1),a.addEventListener("blur",function(){r(a)},!1))}function g(a){a&&(a.addEventListener("input",function(){s(a)},!1),a.addEventListener("focus",function(){s(a)},!1),a.addEventListener("blur",function(){s(a)},!1))}function h(a){a&&a.addEventListener("click",function(){x(a,b)},!1)}var i=a(b),j=(i.querySelector(".clone-controls"),i.querySelector(".clone-target")),k=j.querySelectorAll(".clone"),l=k.length;l++,".consumables"==b&&(na["clone-consumable-count"]=l,o()),".attacks"==b&&(na["clone-attack-count"]=l,o());var m=document.createElement("div");if(m.setAttribute("class","clone"),m.setAttribute("data-clone-count",l),99>=l){j.appendChild(m);var n='<div class="row"><div class="col-xs-8"><div class="input-block"><label class="input-label" for="input-consumable-'+l+'">Item</label><input class="input-field" id="input-consumable-'+l+'" type="text" tabindex="3"></div></div><div class="col-xs-4"><div class="row no-gutter"><div class="col-xs-6"><div class="input-block"><label class="input-label" for="input-consumable-total-'+l+'">Total</label><input class="input-field consumable-total" id="input-consumable-total-'+l+'" type="number" tabindex="3"></div></div><div class="col-xs-6"><div class="input-block"><label class="input-label" for="input-consumable-used-'+l+'">Used</label><input class="input-field consumable-used" id="input-consumable-used-'+l+'" type="number" tabindex="3"></div></div></div></div><div class="col-xs-12"><div class="consumable-counts clearfix"></div><div class="clone-delete-controls"><button class="button button-primary button-small button-icon" id="remove-consumable-'+l+'" tabindex="3"><span class="icon-close"></span> Remove</button></div></div></div>',p='<div class="row no-gutter"><div class="col-xs-6"><div class="input-block"><label class="input-label" for="input-weapon-'+l+'">Weapon</label><input class="input-field" id="input-weapon-'+l+'" type="text" tabindex="3"></div></div><div class="col-xs-3"><div class="input-block"><label class="input-label" for="input-attack-'+l+'">Attack</label><input class="input-field" id="input-attack-'+l+'" type="text" tabindex="3"></div></div><div class="col-xs-3"><div class="input-block"><label class="input-label" for="input-damage-'+l+'">Damage</label><input class="input-field" id="input-damage-'+l+'" type="text" tabindex="3"></div></div><div class="col-xs-4"><div class="input-block"><label class="input-label" for="input-range-'+l+'">Range</label><input class="input-field" id="input-range-'+l+'" type="text" tabindex="3"></div></div><div class="col-xs-4"><div class="input-block"><label class="input-label" for="input-ammo-'+l+'">Ammo</label><input class="input-field" id="input-ammo-'+l+'" type="text" tabindex="3"></div></div><div class="col-xs-4"><div class="input-block"><label class="input-label" for="input-critical-'+l+'">Critical</label><input class="input-field" id="input-critical-'+l+'" type="text" tabindex="3"></div></div><div class="col-xs-12"><div class="clone-delete-controls"><button class="button button-primary button-small button-icon" id="remove-attack-'+l+'" tabindex="3"><span class="icon-close"></span> Remove</button></div></div></div>';".consumables"==b&&(m.innerHTML=n),".attacks"==b&&(m.innerHTML=p)}if(".consumables"==b){if(m.querySelector("#input-consumable-"+l))var t=m.querySelector("#input-consumable-"+l);if(m.querySelector("#input-consumable-total-"+l))var u=m.querySelector("#input-consumable-total-"+l);if(m.querySelector("#input-consumable-used-"+l))var v=m.querySelector("#input-consumable-used-"+l);if(m.querySelector("#remove-consumable-"+l))var w=m.querySelector("#remove-consumable-"+l);c(t),d(t),c(u),d(u),e(u),f(u),c(v),d(v),e(v),g(v),h(w)}if(".attacks"==b){if(m.querySelector("#input-weapon-"+l))var y=m.querySelector("#input-weapon-"+l);if(m.querySelector("#input-attack-"+l))var z=m.querySelector("#input-attack-"+l);if(m.querySelector("#input-range-"+l))var A=m.querySelector("#input-range-"+l);if(m.querySelector("#input-ammo-"+l))var B=m.querySelector("#input-ammo-"+l);if(m.querySelector("#input-damage-"+l))var C=m.querySelector("#input-damage-"+l);if(m.querySelector("#input-critical-"+l))var D=m.querySelector("#input-critical-"+l);if(m.querySelector("#remove-attack-"+l))var w=m.querySelector("#remove-attack-"+l);c(y),d(y),c(z),d(z),c(A),d(A),c(B),d(B),c(C),d(C),c(D),d(D),h(w)}}function x(a,b){var c=f(a,".clone-block"),d=c.querySelector(".clone-target"),e=f(a,".clone"),g=e.querySelectorAll("input");e.remove();for(var h=0;h<g.length;h++)delete na[g[h].id],o();var i=d.querySelectorAll(".clone"),j=i.length;if(0==j)y(b);else{for(var h=0;j>h;h++){var k=h+1;i[h].dataset.cloneCount=k}i=d.querySelectorAll(".clone"),j=i.length;for(var h=0;j>h;h++){for(var k=h+1,l=i[h].querySelectorAll("input"),m=i[h].querySelectorAll("label"),n=0;n<l.length;n++){ca(l[n]);var p=l[n].id,q=p.replace(/\d+/g,""),r=q+k;l[n].id=r,ba(l[n])}for(var s=0;s<m.length;s++){var t=m[s].htmlFor,u=t.replace(/\d+/g,""),v=u+k;m[s].htmlFor=v}}}".consumables"==b&&(na["clone-consumable-count"]=j,o()),".attacks"==b&&(na["clone-attack-count"]=j,o()),0>=j&&(".consumables"==b&&(delete na["clone-consumable-count"],o()),".attacks"==b&&(delete na["clone-attack-count"],o())),".consumables"==b&&ea("Consumables block removed.",!1,!1),".attacks"==b&&ea("Attack block removed.",!1,!1)}function y(b){var f=a(b),g=f.querySelector(".clone-controls"),h=g.querySelector(".clone-remove"),i=(f.querySelectorAll(".clone-delete-controls"),f.querySelector(".clone-target")),j=i.querySelectorAll(".clone"),k=j.length;c(h,"active"),c(h,"button-primary"),c(h,"button-secondary"),"true"==f.dataset.deleteCloneState?(e(f,"delete-state"),f.dataset.deleteCloneState="false"):"false"==f.dataset.deleteCloneState&&(d(f,"delete-state"),f.dataset.deleteCloneState="true"),0==k&&(e(f,"delete-state"),f.dataset.deleteCloneState="false",e(h,"active"),e(h,"button-primary"),d(h,"button-secondary"))}function z(){for(var a=na["clone-consumable-count"],b=na["clone-attack-count"],c=0;a>c;c++)w(".consumables");for(var c=0;b>c;c++)w(".attacks")}function A(){for(var a=b(".hidable-block"),c=0;c<a.length;c++){var d=a[c].querySelector(".hidable-toggle");d.addEventListener("click",function(){B(this)},!1)}}function B(a){var b=(a.textContent,a.querySelector(".icon")),g=a.querySelector(".text"),h=f(a,".hidable-block"),i=h.querySelectorAll(".hidable"),j=h.querySelectorAll(".hidable-on-empty-input"),k=h.querySelectorAll(".hidable-on-empty-textarea");if("true"==h.dataset.allHidden){for(var l=0;l<i.length;l++)e(i[l],"hidden");for(var l=0;l<j.length;l++)e(j[l],"hidden");for(var l=0;l<k.length;l++)e(k[l],"hidden");h.dataset.allHidden="false",c(b,"icon-unfold-less"),c(b,"icon-unfold-more"),g.textContent="Hide"}else if("false"==h.dataset.allHidden){for(var l=0;l<j.length;l++){var m=j[l].querySelector(".input-field");(null==m.value||""==m.value)&&d(j[l],"hidden")}for(var l=0;l<i.length;l++)d(i[l],"hidden");for(var l=0;l<k.length;l++){var n=k[l].querySelector(".textarea");(null==n.textContent||""==n.textContent)&&d(k[l],"hidden")}h.dataset.allHidden="true",c(b,"icon-unfold-less"),c(b,"icon-unfold-more"),g.textContent="Show"}}function C(a,b){var c=(g(a),D(a));b.textContent=c}function D(a){var b=Math.floor((a.value-10)/2);return b}function E(){for(var a=b(".stats"),c=0;c<a.length;c++){var d=a[c].querySelector(".score"),e=a[c].querySelector(".modifier"),f=a[c].querySelector(".score-temp"),g=a[c].querySelector(".modifier-temp");""!==d.value?C(d,e):e.textContent="",""!==f.value?C(f,g):g.textContent=""}}function F(){for(var a=b(".stats .score"),c=b(".stats .score-temp"),d=0;d<a.length;d++)a[d].addEventListener("input",function(){E(),_()},!1);for(var d=0;d<c.length;d++)c[d].addEventListener("input",function(){E(),_()},!1)}function G(){k("stats-str")&&(oa.value=k("stats-str")),k("stats-dex")&&(pa.value=k("stats-dex")),k("stats-con")&&(qa.value=k("stats-con")),k("stats-int")&&(ra.value=k("stats-int")),k("stats-wis")&&(sa.value=k("stats-wis")),k("stats-cha")&&(ta.value=k("stats-cha")),k("stats-strTemp")&&(Aa.value=k("stats-strTemp")),k("stats-dexTemp")&&(Ba.value=k("stats-dexTemp")),k("stats-conTemp")&&(Ca.value=k("stats-conTemp")),k("stats-intTemp")&&(Da.value=k("stats-intTemp")),k("stats-wisTemp")&&(Ea.value=k("stats-wisTemp")),k("stats-chaTemp")&&(Fa.value=k("stats-chaTemp"))}function H(){for(var a=b(".spell-known-item"),c=0;c<a.length;c++){var d=a[c].dataset.eventListener;"false"==d&&(a[c].dataset.eventListener="true",a[c].addEventListener("click",function(){S(this),U()},!1))}}function I(){for(var a=b(".spell-known-item"),c=0;c<a.length;c++)a[c].dataset.eventListener="false",e(a[c],"hidden")}function J(){for(var a=b(".add-spell"),c=0;c<a.length;c++)a[c].addEventListener("click",function(){W(this),U()},!1)}function K(){a("#spells .prepare-spell").addEventListener("click",function(){P(this,"prepare"),U()},!1)}function L(){a("#spells .unprepare-spell").addEventListener("click",function(){P(this,"unprepare"),U()},!1)}function M(){a("#spells .cast-spell").addEventListener("click",function(){P(this,"cast"),U()},!1)}function N(){a("#spells .active-spell").addEventListener("click",function(){P(this,"active"),U()},!1)}function O(){a("#spells .remove-spell").addEventListener("click",function(){P(this,"remove"),U()},!1)}function P(a,b){var c=f(a,"#spells"),g=(c.querySelector(".prepare-spell"),c.querySelector(".unprepare-spell"),c.querySelector(".cast-spell"),c.querySelector(".active-spell"),c.querySelector(".remove-spell")),h=c.querySelectorAll(".spell-state-control");if(a.classList.contains("active")){for(var i=0;i<h.length;i++)e(h[i],"active");c.dataset.prepareSpellState="false",c.dataset.unprepareSpellState="false",c.dataset.castSpellState="false",c.dataset.activeSpellState="false",c.dataset.deleteSpellState="false",e(c,"prepare-state"),e(c,"unprepare-state"),e(c,"cast-state"),e(c,"active-state"),e(c,"delete-state"),e(g,"button-primary"),d(g,"button-secondary")}else{for(var i=0;i<h.length;i++)e(h[i],"active");d(a,"active"),"prepare"==b?(c.dataset.prepareSpellState="true",c.dataset.unprepareSpellState="false",c.dataset.castSpellState="false",c.dataset.activeSpellState="false",c.dataset.deleteSpellState="false",d(c,"prepare-state"),e(c,"unprepare-state"),e(c,"cast-state"),e(c,"active-state"),e(c,"delete-state"),e(g,"button-primary"),d(g,"button-secondary")):"unprepare"==b?(c.dataset.prepareSpellState="false",c.dataset.unprepareSpellState="true",c.dataset.castSpellState="false",c.dataset.activeSpellState="false",c.dataset.deleteSpellState="false",e(c,"prepare-state"),d(c,"unprepare-state"),e(c,"cast-state"),e(c,"active-state"),e(c,"delete-state"),e(g,"button-primary"),d(g,"button-secondary")):"cast"==b?(c.dataset.prepareSpellState="false",c.dataset.unprepareSpellState="false",c.dataset.castSpellState="true",c.dataset.activeSpellState="false",c.dataset.deleteSpellState="false",e(c,"prepare-state"),e(c,"unprepare-state"),d(c,"cast-state"),e(c,"active-state"),e(c,"delete-state"),e(g,"button-primary"),d(g,"button-secondary")):"active"==b?(c.dataset.prepareSpellState="false",c.dataset.unprepareSpellState="false",c.dataset.castSpellState="false",c.dataset.activeSpellState="true",c.dataset.deleteSpellState="false",e(c,"prepare-state"),e(c,"unprepare-state"),e(c,"cast-state"),d(c,"active-state"),e(c,"delete-state"),e(g,"button-primary"),d(g,"button-secondary")):"remove"==b&&(c.dataset.prepareSpellState="false",c.dataset.unprepareSpellState="false",c.dataset.castSpellState="false",c.dataset.activeSpellState="false",c.dataset.deleteSpellState="true",e(c,"prepare-state"),e(c,"unprepare-state"),e(c,"cast-state"),e(c,"active-state"),d(c,"delete-state"),d(g,"button-primary"),e(g,"button-secondary"))}}function Q(){for(var a=b(".add-spell"),c=0;c<a.length;c++){var d=f(a[c],".new-spell"),e=d.querySelector("input");e.addEventListener("keypress",function(){R(this)},!1)}}function R(a){var b=event.keyCode||event.which;13==b&&(W(a),U())}function S(a){var b=f(a,"#spells"),g=(f(a,".spell-level").dataset.spellLevel,b.dataset.prepareSpellState),h=b.dataset.unprepareSpellState,i=b.dataset.castSpellState,k=b.dataset.activeSpellState,l=b.dataset.deleteSpellState,m=a.querySelector(".spell-marks"),n=a.querySelector(".spell-active");if("true"==g){var o=document.createElement("span");o.setAttribute("class","icon icon-radio-button-checked"),m.insertBefore(o,m.firstChild),m.children.length>0&&(d(a,"button-primary"),e(a,"button-tertiary"),e(a,"hidable"))}if("true"==h&&(m.firstChild&&m.firstChild.remove(),m.children.length<=0&&(e(a,"button-primary"),d(a,"button-tertiary"),d(a,"hidable"))),"true"==i){for(var p=m.children,q=0,r=0;r<p.length;r++)if(p[r].classList.contains("icon-radio-button-checked")){c(p[r],"icon-radio-button-checked"),c(p[r],"icon-radio-button-unchecked");break}for(var r=0;r<p.length;r++)p[r].classList.contains("icon-radio-button-checked")&&q++;0>=q&&(e(a,"button-primary"),d(a,"button-tertiary"))}if("true"==k){var s=document.createElement("span");s.setAttribute("class","icon icon-play-arrow"),m.children.length>0&&(n.children.length>0?n.firstChild.remove():n.appendChild(s)),m.children.length<=0&&n.children.length>0&&n.firstChild.remove()}if("true"==l){var t=a.dataset.spellName,u=a.textContent,v=t.replace(/\s+/g,"-").toLowerCase();j("spell-saved-"+v),a.remove(),ea(u+" removed.",!1,!1)}}function T(a){var b=document.createElement("button");b.setAttribute("data-spell-name",a.replace(/\s+/g,"-").toLowerCase()),b.setAttribute("id",a.replace(/\s+/g,"-").toLowerCase()),b.setAttribute("data-event-listener","false"),b.setAttribute("class","spell-known-item button button-tertiary hidable"),b.textContent=a;var c=document.createElement("span");c.setAttribute("class","spell-marks"),b.appendChild(c);var d=document.createElement("span");return d.setAttribute("class","spell-active"),b.appendChild(d),b}function U(){for(var a=b(".spell-known-item"),c=function(a,b,c,d,e){this.name=a,this.level=b,this.prepared=c||0,this.active=d||!1,this.cast=e||0},d=0;d<a.length;d++){var e=a[d].textContent,g=f(a[d],".spell-level").dataset.spellLevel,h=a[d].querySelector(".spell-marks").children.length,i=a[d].querySelector(".spell-marks").querySelectorAll(".icon-radio-button-unchecked").length,j=a[d].querySelector(".spell-active").children.length;j=j>0?!0:!1;var k=new c(e,g,h,j,i);na["spell-saved-"+k.name.replace(/\s+/g,"-").toLowerCase()]=JSON.stringify(k),o()}}function V(){var b=[];for(var c in na)"spell-saved"==c.substring(0,11)&&b.push(JSON.parse(na[c]));for(var c=0;c<b.length;c++){var f=b[c],g=a(".spells-known.spell-level-"+f.level);if(g.querySelector("#"+f.name.replace(/\s+/g,"-").toLowerCase()))var h=g.querySelector("#"+f.name.replace(/\s+/g,"-").toLowerCase());else{var h=T(f.name);g.appendChild(h)}var i=h.querySelector(".spell-marks"),j=h.querySelector(".spell-active");if(f.prepared>0){e(h,"hidable"),e(h,"button-tertiary"),d(h,"button-primary");for(var k=0;k<f.prepared;k++){var l=document.createElement("span");l.setAttribute("class","icon icon-radio-button-checked"),i.insertBefore(l,i.firstChild)}}if(f.cast>0){for(var m=i.querySelectorAll(".icon-radio-button-checked"),k=0;k<f.cast;k++)m[k]&&(e(m[k],"icon-radio-button-checked"),d(m[k],"icon-radio-button-unchecked"));f.cast>=f.prepared&&(e(h,"button-primary"),d(h,"button-tertiary"))}if(f.active){var n=document.createElement("span");n.setAttribute("class","icon icon-play-arrow"),f.prepared>0&&(j.children.length>0?j.firstChild.remove():j.appendChild(n))}}}function W(a){var b=f(a,".spell-level").dataset.spellLevel,c=f(a,".new-spell"),d=f(a,".spell-level").querySelector(".spells-known"),e=c.querySelector("input"),g=e.value,h=T(g),i=function(a,b,c,d,e){this.name=a,this.level=b,this.prepared=c||0,this.active=d||!1,this.cast=e||0};if(""!==g)if(isNaN(g.charAt(0))){d.appendChild(h),e.value="";var h=new i(g,parseInt(b,10),0,!1,0);na["spell-saved-"+h.name.replace(/\s+/g,"-").toLowerCase()]=JSON.stringify(h),o(),ea(g+" added to spell level "+b+".",!1,!1)}else ea("Can't start with a number.",!1,!1);H()}function X(a){na[a.id]=a.innerHTML,o()}function Y(){for(var c=b(".textarea"),d=0;d<c.length;d++){var e=c[d].id;na[e]&&(a("#"+e).innerHTML=na[e])}}function Z(){for(var a=b(".textarea"),c=0;c<a.length;c++)a[c].addEventListener("input",function(){X(this)},!1),a[c].addEventListener("focus",function(){X(this)},!1),a[c].addEventListener("blur",function(){X(this)},!1)}function $(a){var b,c=a.parentNode,f=c.querySelector(".input-field");if(c.querySelector(".input-label"))var b=c.querySelector(".input-label");c.querySelector(".input-label")&&(f==document.activeElement?d(b,"input-label-focus"):e(b,"input-label-focus"))}function _(){function c(){x.length>0&&(y=x.reduce(function(a,b){return a+b}))}for(var d=b(".input-total-block"),e=0;e<d.length;e++){for(var f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=d[e].querySelector(".total"),w=(parseInt(d[e].querySelector(".total").textContent,10)||0,d[e].querySelectorAll(".input-field")),x=[],y=0,z=0;z<w.length;z++)w.length>0&&"true"==w[z].dataset.modifier&&x.push(parseInt(w[z].value,10)||0);c(),"true"==d[e].dataset.strBonus&&(f=""==Ga.textContent?parseInt(ua.textContent,10):parseInt(Ga.textContent,10)),"true"==d[e].dataset.dexBonus&&(g=""==Ha.textContent?parseInt(va.textContent,10):parseInt(Ha.textContent,10)),"true"==d[e].dataset.conBonus&&(h=""==Ia.textContent?parseInt(wa.textContent,10):parseInt(Ia.textContent,10)),"true"==d[e].dataset.intBonus&&(i=""==Ja.textContent?parseInt(xa.textContent,10):parseInt(Ja.textContent,10)),"true"==d[e].dataset.wisBonus&&(j=""==Ka.textContent?parseInt(ya.textContent,10):parseInt(Ka.textContent,10)),"true"==d[e].dataset.chaBonus&&(k=""==La.textContent?parseInt(za.textContent,10):parseInt(La.textContent,10)),"true"==d[e].dataset.babBonus&&(l=parseInt(a("#input-base-attack").value,10)),
"true"==d[e].dataset.sizeBonus&&(m=parseInt(a("#input-size-bonus").value,10)),"true"==d[e].dataset.specialSizeBonus&&(n=parseInt(a("#input-special-size-bonus").value,10)),"true"==d[e].dataset.levelBonus&&(o=parseInt(a("#input-level").value,10)),"true"==d[e].dataset.acArmor&&(q=parseInt(a("#input-ac-armor").value,10)),"true"==d[e].dataset.acShield&&(r=parseInt(a("#input-ac-shield").value,10)),"true"==d[e].dataset.acDeflect&&(s=parseInt(a("#input-ac-deflect").value,10)),"true"==d[e].dataset.acDodge&&(t=parseInt(a("#input-ac-dodge").value,10)),"true"==d[e].dataset.acNatural&&(u=parseInt(a("#input-ac-natural").value,10)),"true"==d[e].dataset.plusTenBonus&&(p=10),isNaN(o)&&(o=0),isNaN(f)&&(f=0),isNaN(g)&&(g=0),isNaN(h)&&(h=0),isNaN(i)&&(i=0),isNaN(j)&&(j=0),isNaN(k)&&(k=0),isNaN(l)&&(l=0),isNaN(m)&&(m=0),isNaN(n)&&(n=0),isNaN(o)&&(o=0),isNaN(p)&&(p=0),isNaN(q)&&(q=0),isNaN(r)&&(r=0),isNaN(s)&&(s=0),isNaN(t)&&(t=0),isNaN(u)&&(u=0);var A=y+o+l+m+n+p+f+g+h+i+j+k+q+r+s+t+u;v.textContent=A}}function aa(){for(var a=b(".input-block"),c=0;c<a.length;c++){var d=a[c].querySelector(".input-field");d.addEventListener("input",function(){$(this),ba(this),_()},!1),d.addEventListener("focus",function(){$(this),ba(this),_()},!1),d.addEventListener("blur",function(){$(this),ba(this),_()},!1)}}function ba(a){na[a.id]=a.value,o()}function ca(a){var b=a.id;j(b)}function da(){for(var c=b(".input-block"),d=0;d<c.length;d++){var e=c[d].querySelector(".input-field").id;na[e]&&(a("#"+e).value=na[e])}}function ea(b,c,f,g,i,j,k){function l(){e(y,"reveal")}function m(){y.remove()}var n=a(".snacks .snack-bars"),o=document.createElement("div");o.setAttribute("class","snack-bar"),o.setAttribute("data-roll-name",k),o.setAttribute("data-ammount-of-dice",g),o.setAttribute("data-dice",i),o.setAttribute("data-ammount-of-bonus",j);var p=document.createElement("div");p.setAttribute("class","row");var q=document.createElement("div");q.setAttribute("class","col-xs-7");var r=document.createElement("div");r.setAttribute("class","col-xs-5");var s=document.createElement("button");s.setAttribute("class","button button-dark button-small snack-clear");var t=document.createElement("button");t.setAttribute("class","button button-dark button-small snack-undo"),t.textContent="Undo";var u=document.createElement("span");u.setAttribute("class","icon-close");var v=document.createElement("p");v.setAttribute("class","snack-message"),v.textContent=b,s.appendChild(u),c&&r.appendChild(s),f&&r.appendChild(t),q.appendChild(v),p.appendChild(q),p.appendChild(r),o.appendChild(p);for(var w=n.querySelectorAll(".snack-bar"),x=0;x<w.length;x++){var y=w[x];h(l,100),h(m,400)}n.appendChild(o),fa(o);var z=function(){d(o,"reveal")};h(z,10);var A=function(){o&&ha(o)};h(A,5e3)}function fa(a){var b=f(a,".snack-bar"),c=b.querySelector(".snack-clear"),d=b.querySelector(".snack-undo");c&&c.addEventListener("click",function(){ha(this)},!1),d&&d.addEventListener("click",function(){ga(this),i("saved-formulas",element_formulas_list),checkListListState()},!1)}function ga(a){var b=f(a,".snack-bar"),c=b.dataset.rollName,d=parseInt(b.dataset.ammountOfDice,10),e=parseInt(b.dataset.dice,10),g=parseInt(b.dataset.ammountOfBonus,10);"nameless formula"==c&&(c=""),saveCurrentFormula(d,e,g,c),ha(a)}function ha(b){function c(){e(g,"reveal")}function d(){g.remove()}if(b)var g=f(b,".snack-bar");else var g=a(".snack-bar");g&&(h(c,10),h(d,500))}function ia(b,c,e){function f(){d(j,"reveal"),d(i,"reveal")}var g=a("body"),i=document.createElement("div");i.setAttribute("class","prompt prompt-shade");var j=document.createElement("div");j.setAttribute("class","prompt prompt-modal");var k=document.createElement("div");k.setAttribute("class","container");var l=document.createElement("div");l.setAttribute("class","row");var m=document.createElement("div");m.setAttribute("class","row");var n=document.createElement("div");n.setAttribute("class","col-xs-12");var o=document.createElement("div");o.setAttribute("class","col-xs-6");var p=document.createElement("div");p.setAttribute("class","col-xs-6");var q=document.createElement("div");q.setAttribute("class","prompt-message");var r=document.createElement("h1");r.textContent=b;var s=document.createElement("p");s.textContent=c;var t=document.createElement("button");t.setAttribute("class","button button-primary button-block prompt-action"),t.textContent="OK";var u=document.createElement("button");u.setAttribute("class","button button-secondary button-block prompt-cancel"),u.textContent="Cancel",q.appendChild(r),q.appendChild(s),n.appendChild(q),o.appendChild(u),p.appendChild(t),l.appendChild(n),m.appendChild(o),m.appendChild(p),k.appendChild(l),k.appendChild(m),j.appendChild(k),g.querySelector(".prompt.prompt-shade")||g.querySelector(".prompt.prompt-modal")||(g.appendChild(i),g.appendChild(j),h(f,10),ja(e))}function ja(b){var c=a(".prompt-shade"),d=(a(".prompt-modal"),a(".prompt-modal .prompt-action")),e=a(".prompt-modal .prompt-cancel");c.addEventListener("click",function(){ka()}),e.addEventListener("click",function(){ka()}),d.addEventListener("click",function(){"clear all"==b&&la()})}function ka(){function b(){c.remove(),d.remove()}var c=a(".prompt-shade"),d=a(".prompt-modal");a(".prompt-modal .prompt-cancel");c&&d&&(c.style.opacity=0,d.style.opacity=0,h(b,500))}function la(){localStorage.clear(),document.location.reload(!0),ka()}var ma,na,oa=a(".stats.str .score"),pa=a(".stats.dex .score"),qa=a(".stats.con .score"),ra=a(".stats.int .score"),sa=a(".stats.wis .score"),ta=a(".stats.cha .score"),ua=a(".stats.str .modifier"),va=a(".stats.dex .modifier"),wa=a(".stats.con .modifier"),xa=a(".stats.int .modifier"),ya=a(".stats.wis .modifier"),za=a(".stats.cha .modifier"),Aa=a(".stats.str .score-temp"),Ba=a(".stats.dex .score-temp"),Ca=a(".stats.con .score-temp"),Da=a(".stats.int .score-temp"),Ea=a(".stats.wis .score-temp"),Fa=a(".stats.cha .score-temp"),Ga=a(".stats.str .modifier-temp"),Ha=a(".stats.dex .modifier-temp"),Ia=a(".stats.con .modifier-temp"),Ja=a(".stats.int .modifier-temp"),Ka=a(".stats.wis .modifier-temp"),La=a(".stats.cha .modifier-temp"),Ma=a("nav"),Na=a("nav .toggle-nav"),Oa=a(".clear-all"),Pa=a(".toggle-fullscreen");Pa.addEventListener("click",function(){p()},!1),Oa.addEventListener("click",function(){ia("Are you sure?","All information will be removed. This can not be undone.","clear all"),e(Ma,"open")},!1),Na.addEventListener("click",function(){c(Ma,"open")},!1),window.addEventListener("click",function(a){a.target!=Ma&&f(a.target,"nav")!=Ma&&e(Ma,"open")}),window.addEventListener("keydown",function(a){27==a.keyCode&&(ka(),ha())},!1),l(),m(),z(),n(),G(),V(),Y(),da(),I(),E(),_(),t(),u(),H(),F(),J(),Q(),K(),L(),M(),N(),O(),A(),Z(),aa(),v()})();!function(){smoothScroll.init({speed:500})}();